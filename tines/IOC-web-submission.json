{
  "schema_version": 26,
  "standard_lib_version": 73,
  "action_runtime_version": 28,
  "name": "IOC Web Submission",
  "description": "Submit IPv4 IOCs for enrichment",
  "guid": "c7ab9dca268e2beb0e350df8150ed8e6",
  "slug": "ioc_web_submission",
  "agents": [
    {
      "type": "Agents::FormAgent",
      "name": "IOC Submission Webform",
      "disabled": false,
      "description": "A security analyst can submit Indicators of Compromise to check the disposition",
      "guid": "020d4b8cceed45713c205da9feac1783",
      "origin_story_identifier": "cloud:0babdfaca84c3865dc5749e64fde82f5:c7ab9dca268e2beb0e350df8150ed8e6",
      "options": {
        "fields": "",
        "mode": "story_run",
        "visibility": "tenant",
        "anonymize": false,
        "auto_submit": false,
        "page_logo": {
          "name": "TinesLogoWhite-PurpleBG.svg",
          "type": "image/svg+xml",
          "contents": "PHN2ZyB3aWR0aD0iMTkyMCIgaGVpZ2h0PSIxMDgwIiB2aWV3Qm94PSIwIDAgMTkyMCAxMDgwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cmVjdCB3aWR0aD0iMTkyMCIgaGVpZ2h0PSIxMDgwIiBmaWxsPSIjOEQ3NUU2Ii8+CjxwYXRoIGQ9Ik05MDIuMjgxIDQ5OC44NjhIODgwLjAxNFY1MjIuMDM0SDkwMi4yODFWNTcyLjY0MUM5MDIuMjgxIDU5Ny44MzIgOTE4LjQ3NSA2MTIuMjI3IDk0My4yMTYgNjEyLjIyN0g5NjEuNDM0VjU4Ny4yNjFIOTQ2LjM2NUM5MzYuMDE5IDU4Ny4yNjEgOTI5Ljk0NiA1ODEuNDEzIDkyOS45NDYgNTY5Ljk0MlY1MjIuMDM0SDk2MS40MzRWNDk4Ljg2OEg5MjkuOTQ2VjQ2NC42OEg5MDIuMjgxVjQ5OC44NjhaIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNOTc0LjMyNyA0ODEuMDk5SDEwMDQuOTJWNDQ5LjYxSDk3NC4zMjdWNDgxLjA5OVpNMTAwMy4zNCA2MTIuMjI3VjQ5OC44NjhIOTc1LjY3NlY2MTIuMjI3SDEwMDMuMzRaIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNMTA0Ny45NyA2MTIuMjI3VjU1MC4zNzRDMTA0Ny45NyA1MzMuNzMgMTA1OC43NiA1MjEuNTg0IDEwNzQuMjggNTIxLjU4NEMxMDg4LjQ1IDUyMS41ODQgMTA5Ny45IDUzMi4zODEgMTA5Ny45IDU0Ny45VjYxMi4yMjdIMTEyNS41NlY1NDIuMDUyQzExMjUuNTYgNTE1LjUxMiAxMTA4LjkyIDQ5Ny4wNjggMTA4My4yOCA0OTcuMDY4QzEwNjcuMDggNDk3LjA2OCAxMDU0LjI2IDUwNC4wNDEgMTA0Ny45NyA1MTYuNDExVjQ5OC44NjhIMTAyMC4zVjYxMi4yMjdIMTA0Ny45N1oiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik0xMjIwLjUxIDU3NC40NEMxMjE3LjU4IDU4NS4yMzcgMTIwOC4zNiA1OTEuMDg0IDExOTQuMTkgNTkxLjA4NEMxMTc2LjY1IDU5MS4wODQgMTE2NC45NSA1NzkuMzg5IDExNjIuOTMgNTYxLjE3SDEyNDYuNkMxMjQ2LjgyIDU1OC45MjEgMTI0Ny4wNSA1NTUuNTQ3IDEyNDcuMDUgNTUxLjcyNEMxMjQ3LjA1IDUyNC43MzMgMTIyOS45NSA0OTcuMDY4IDExOTEuOTQgNDk3LjA2OEMxMTU0LjgzIDQ5Ny4wNjggMTEzNi4zOSA1MjUuMTgzIDExMzYuMzkgNTU1LjA5N0MxMTM2LjM5IDU4NC43ODcgMTE1Ny4wOCA2MTQuMDI2IDExOTQuMTkgNjE0LjAyNkMxMjIyLjA4IDYxNC4wMjYgMTI0My4yMiA1OTguNTA3IDEyNDcuNSA1NzQuNDRIMTIyMC41MVpNMTE5MS45NCA1MTcuNzYxQzEyMDguMzYgNTE3Ljc2MSAxMjE4LjI2IDUyOC41NTcgMTIxOS4zOCA1NDIuOTUySDExNjMuNkMxMTY2LjUzIDUyNS44NTggMTE3Ni40MiA1MTcuNzYxIDExOTEuOTQgNTE3Ljc2MVoiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik0xMzAyLjU4IDYxNC4wMjZDMTMyOS4xMiA2MTQuMDI2IDEzNDYuNDQgNjAwLjA4MSAxMzQ2LjQ0IDU3OC43MTRDMTM0Ni40NCA1MjcuNDMyIDEyODMuNDcgNTU0LjQyMyAxMjgzLjQ3IDUyOS45MDZDMTI4My40NyA1MjIuMjU5IDEyODkuOTkgNTE3Ljc2MSAxMjk5Ljg4IDUxNy43NjFDMTMwOC42NiA1MTcuNzYxIDEzMTguMzMgNTIzLjE1OSAxMzE5LjkgNTMzLjczSDEzNDUuMDlDMTM0My45NyA1MTEuNjg4IDEzMjUuNzUgNDk3LjA2OCAxMjk5LjIxIDQ5Ny4wNjhDMTI3NS44MiA0OTcuMDY4IDEyNTguNSA1MTEuMDEzIDEyNTguNSA1MzAuODA2QzEyNTguNSA1NzguNzE0IDEzMjAuNTggNTU0LjY0OCAxMzIwLjU4IDU3OS44MzlDMTMyMC41OCA1ODYuNTg2IDEzMTMuMzggNTkxLjk4NCAxMzAyLjU4IDU5MS45ODRDMTI5MC4yMSA1OTEuOTg0IDEyODEuODkgNTg1LjIzNyAxMjgwLjc3IDU3NC40NEgxMjU1LjU4QzEyNTYuOTMgNTk4LjczMiAxMjc1LjE0IDYxNC4wMjYgMTMwMi41OCA2MTQuMDI2WiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik02NTguMzk3IDQyMEM2MjkuOTkzIDQyMCA2MDQuODc4IDQzOC40MzEgNTk2LjM3OCA0NjUuNTE1TDU3MyA1NDBMNTk2LjM3OCA2MTQuNDg1QzYwNC44NzggNjQxLjU2OSA2MjkuOTkzIDY2MCA2NTguMzk3IDY2MEg3MjEuMzY5Qzc0OS43NzMgNjYwIDc3NC44ODcgNjQxLjU2OSA3ODMuMzg4IDYxNC40ODVMODA2Ljc2NiA1NDBMNzgzLjM4OCA0NjUuNTE1Qzc3NC44ODcgNDM4LjQzMSA3NDkuNzczIDQyMCA3MjEuMzY5IDQyMEg2NTguMzk3Wk03MjEuMzcgNDM4LjcyM0M3NDEuNTg3IDQzOC43MjMgNzU5LjQ2MiA0NTEuODQxIDc2NS41MTMgNDcxLjExOEw3NzEuMjQ0IDQ4OS4zOEM3NTkuNzE0IDQ3OS44NjEgNzQ1LjExMyA0NzQuNTA0IDcyOS44NTIgNDc0LjUwM0w2NDkuNzQzIDQ3NC41MDFDNjM0LjU4NSA0NzQuNTAyIDYyMC4wNzggNDc5Ljc4OCA2MDguNTg1IDQ4OS4xODZMNjE0LjI1NSA0NzEuMTE4QzYyMC4zMDYgNDUxLjg0MSA2MzguMTgxIDQzOC43MjMgNjU4LjM5OCA0MzguNzIzSDcyMS4zN1pNNjEyLjkwOSA1MTEuNDg5TDU5OC4zNTMgNTMwLjYzOUw3ODEuMjQxIDUzMC42MzlMNzY2LjY4NyA1MTEuNDkyQzc1Ny45MzkgNDk5Ljk4NSA3NDQuMzExIDQ5My4yMjcgNzI5Ljg1MSA0OTMuMjI2SDY0OS4zMDdDNjM1LjAxIDQ5My4zNjEgNjIxLjU2OCA1MDAuMDk5IDYxMi45MDkgNTExLjQ4OVpNNzgxLjIxMiA1NDkuMzYyTDc2Ni42ODUgNTY4LjQ5MkM3NTcuOTM3IDU4MC4wMTEgNzQ0LjMgNTg2Ljc3NyA3MjkuODI4IDU4Ni43NzZMNjQ5Ljc2NSA1ODYuNzc0QzYzNS4yOTQgNTg2Ljc3NSA2MjEuNjU2IDU4MC4wMDkgNjEyLjkwOCA1NjguNDg5TDU5OC4zODMgNTQ5LjM2Mkw3ODEuMjEyIDU0OS4zNjJaTTYxNC4yNTQgNjA4Ljg4MkM2MjAuMzA1IDYyOC4xNTkgNjM4LjE4IDY0MS4yNzcgNjU4LjM5NyA2NDEuMjc3SDcyMS4zNjlDNzQxLjU4NiA2NDEuMjc3IDc1OS40NjEgNjI4LjE1OSA3NjUuNTExIDYwOC44ODJMNzcxLjI0NyA1OTAuNjA3Qzc1OS43MTIgNjAwLjEzNiA3NDUuMSA2MDUuNSA3MjkuODI3IDYwNS40OTlMNjQ5Ljc2NiA2MDUuNDk3QzYzNC41OTYgNjA1LjQ5OCA2MjAuMDc3IDYwMC4yMDYgNjA4LjU3OCA1OTAuNzk1TDYxNC4yNTQgNjA4Ljg4MloiIGZpbGw9IndoaXRlIi8+Cjwvc3ZnPgo=",
          "display_logo": true
        },
        "page_width": "large",
        "pages_action_color": "#010101",
        "pages_appearance_mode": "dark",
        "pages_background_color": "#FDF3F3",
        "url_identifier": "57cb17fe0bc6f3abc14d2078eea9a285",
        "loading_message": "Please waitâ€¦",
        "auto_submit_time": null
      },
      "reporting": {
        "time_saved_value": 0,
        "time_saved_unit": "minutes"
      },
      "monitoring": {
        "monitor_all_events": false,
        "monitor_failures": false,
        "monitor_no_events_emitted": null
      },
      "template": {
        "created_from_template_guid": null,
        "created_from_template_version": null,
        "template_tags": []
      },
      "width": null
    },
    {
      "type": "Agents::TriggerAgent",
      "name": "CSV Uploaded?",
      "disabled": false,
      "description": null,
      "guid": "5e23b9d6a3c747bc9d4c2bc2f5708f58",
      "origin_story_identifier": "cloud:0babdfaca84c3865dc5749e64fde82f5:c7ab9dca268e2beb0e350df8150ed8e6",
      "options": {
        "rules": [
          {
            "path": "=ioc_submission_webform.body.upload_csv.type",
            "type": "in",
            "value": "text"
          }
        ]
      },
      "reporting": {
        "time_saved_value": 0,
        "time_saved_unit": "minutes"
      },
      "monitoring": {
        "monitor_all_events": false,
        "monitor_failures": false,
        "monitor_no_events_emitted": null
      },
      "template": {
        "created_from_template_guid": null,
        "created_from_template_version": null,
        "template_tags": []
      },
      "width": null
    },
    {
      "type": "Agents::EventTransformationAgent",
      "name": "Parse CSV",
      "disabled": false,
      "description": null,
      "guid": "5a05cbd7cb273afe524e4e01f451757e",
      "origin_story_identifier": "cloud:0babdfaca84c3865dc5749e64fde82f5:c7ab9dca268e2beb0e350df8150ed8e6",
      "options": {
        "mode": "message_only",
        "loop": false,
        "payload": {
          "data": "=CSV_PARSE_TO_OBJECTS(BASE64_DECODE(ioc_submission_webform.body.upload_csv.contents))"
        }
      },
      "reporting": {
        "time_saved_value": 0,
        "time_saved_unit": "minutes"
      },
      "monitoring": {
        "monitor_all_events": false,
        "monitor_failures": false,
        "monitor_no_events_emitted": null
      },
      "template": {
        "created_from_template_guid": null,
        "created_from_template_version": null,
        "template_tags": []
      },
      "width": null,
      "schedule": null
    },
    {
      "type": "Agents::EventTransformationAgent",
      "name": "Extract IPs",
      "disabled": false,
      "description": null,
      "guid": "78ea80d7152301db4379ae88c66eca0f",
      "origin_story_identifier": "cloud:0babdfaca84c3865dc5749e64fde82f5:c7ab9dca268e2beb0e350df8150ed8e6",
      "options": {
        "mode": "extract",
        "matchers": [
          {
            "path": "=ioc_submission_webform.body.ipv4_iocs",
            "regexp": "\\b(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\b",
            "to": "ip"
          }
        ]
      },
      "reporting": {
        "time_saved_value": 0,
        "time_saved_unit": "minutes"
      },
      "monitoring": {
        "monitor_all_events": false,
        "monitor_failures": false,
        "monitor_no_events_emitted": null
      },
      "template": {
        "created_from_template_guid": null,
        "created_from_template_version": null,
        "template_tags": []
      },
      "width": null,
      "schedule": null
    },
    {
      "type": "Agents::EventTransformationAgent",
      "name": "Extract IOC Regex",
      "disabled": false,
      "description": null,
      "guid": "58d6b736851c40f4c8736554728ea13f",
      "origin_story_identifier": "cloud:256caef50de818d681816208610a2c92:ae34c02c010f867a087c972f2b2ea507",
      "options": {
        "mode": "extract",
        "matchers": [
          {
            "path": "=",
            "regexp": "(?:[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?\\.)+[a-z0-9][a-z0-9-]{0,61}[a-z0-9]",
            "to": "domain"
          },
          {
            "path": "=ioc_submission_webform.body.ipv4_iocs ||\"\"",
            "regexp": "\\b(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\b",
            "to": "ip"
          },
          {
            "path": "=",
            "regexp": "\\b[a-fA-F0-9]{64}\\b",
            "to": "sha256"
          },
          {
            "path": "=your_path",
            "regexp": "\\b[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+.[a-zA-Z]{2,4}\\b",
            "to": "email"
          }
        ]
      },
      "reporting": {
        "time_saved_value": 0,
        "time_saved_unit": "minutes"
      },
      "monitoring": {
        "monitor_all_events": false,
        "monitor_failures": false,
        "monitor_no_events_emitted": null
      },
      "template": {
        "created_from_template_guid": null,
        "created_from_template_version": null,
        "template_tags": []
      },
      "width": null,
      "schedule": null
    },
    {
      "type": "Agents::EventTransformationAgent",
      "name": "Explode IPs",
      "disabled": false,
      "description": null,
      "guid": "f87763ac857e0e2454d003f167f7860b",
      "origin_story_identifier": "cloud:256caef50de818d681816208610a2c92:bac1778d8b4dce1bb66630941d1ec794",
      "options": {
        "mode": "explode",
        "path": "=MAP(parse_csv.data, \"ip\")",
        "to": "ip",
        "limit": "50000"
      },
      "reporting": {
        "time_saved_value": 0,
        "time_saved_unit": "minutes"
      },
      "monitoring": {
        "monitor_all_events": false,
        "monitor_failures": false,
        "monitor_no_events_emitted": null
      },
      "template": {
        "created_from_template_guid": null,
        "created_from_template_version": null,
        "template_tags": []
      },
      "width": null,
      "schedule": null
    },
    {
      "type": "Agents::HTTPRequestAgent",
      "name": "Search for IP Address",
      "disabled": false,
      "description": "Search for an IP Address in VirusTotal. Report returns asn information, download samples, resolutions, detected and undetected urls etc.\n\nLink to documentation: https://virustotal.readme.io/reference/ip-info",
      "guid": "1348fa66f3dfa0892fc26529496c8cc3",
      "origin_story_identifier": "cloud:0babdfaca84c3865dc5749e64fde82f5:c7ab9dca268e2beb0e350df8150ed8e6",
      "options": {
        "url": "https://www.virustotal.com/api/v3/ip_addresses/<<INPUT.ip_address>>",
        "method": "get",
        "headers": {
          "x-apikey": "<<INPUT.virustotal_credential>>"
        }
      },
      "reporting": {
        "time_saved_value": 0,
        "time_saved_unit": "minutes"
      },
      "monitoring": {
        "monitor_all_events": false,
        "monitor_failures": false,
        "monitor_no_events_emitted": null
      },
      "template": {
        "created_from_template_guid": "6ec39048bdf2b511750207e63fe891d5bc9584dc3898999be867f46854170db4",
        "created_from_template_version": null,
        "template_tags": []
      },
      "width": null,
      "schedule": null
    },
    {
      "type": "Agents::TriggerAgent",
      "name": "Malicious?",
      "disabled": false,
      "description": null,
      "guid": "47f3100b599674fd12cfdefc2ee565ee",
      "origin_story_identifier": "cloud:0babdfaca84c3865dc5749e64fde82f5:c7ab9dca268e2beb0e350df8150ed8e6",
      "options": {
        "rules": [
          {
            "path": "=search_for_ip_address.body.data.attributes.last_analysis_stats.malicious",
            "type": "field>value",
            "value": "3"
          }
        ]
      },
      "reporting": {
        "time_saved_value": 0,
        "time_saved_unit": "minutes"
      },
      "monitoring": {
        "monitor_all_events": false,
        "monitor_failures": false,
        "monitor_no_events_emitted": null
      },
      "template": {
        "created_from_template_guid": null,
        "created_from_template_version": null,
        "template_tags": []
      },
      "width": null
    },
    {
      "type": "Agents::EventTransformationAgent",
      "name": "Throttle",
      "disabled": false,
      "description": null,
      "guid": "15a1d0ea2f79420206e077792b20abe7",
      "origin_story_identifier": "cloud:0babdfaca84c3865dc5749e64fde82f5:c7ab9dca268e2beb0e350df8150ed8e6",
      "options": {
        "mode": "throttle",
        "interval": "minute",
        "capacity": "60",
        "events_per_run": 1
      },
      "reporting": {
        "time_saved_value": 0,
        "time_saved_unit": "minutes"
      },
      "monitoring": {
        "monitor_all_events": false,
        "monitor_failures": false,
        "monitor_no_events_emitted": null
      },
      "template": {
        "created_from_template_guid": null,
        "created_from_template_version": null,
        "template_tags": []
      },
      "width": null
    },
    {
      "type": "Agents::EventTransformationAgent",
      "name": "Explode IPs",
      "disabled": false,
      "description": null,
      "guid": "67c0a7cbfc4e778893e820c1c5afbd0f",
      "origin_story_identifier": "cloud:0babdfaca84c3865dc5749e64fde82f5:c7ab9dca268e2beb0e350df8150ed8e6",
      "options": {
        "mode": "explode",
        "path": "=extract_ips.ip",
        "to": "ip",
        "limit": "500"
      },
      "reporting": {
        "time_saved_value": 0,
        "time_saved_unit": "minutes"
      },
      "monitoring": {
        "monitor_all_events": false,
        "monitor_failures": false,
        "monitor_no_events_emitted": null
      },
      "template": {
        "created_from_template_guid": null,
        "created_from_template_version": null,
        "template_tags": []
      },
      "width": null,
      "schedule": null
    },
    {
      "type": "Agents::EventTransformationAgent",
      "name": "Convert Modification Dates",
      "disabled": false,
      "description": null,
      "guid": "e37b6dba48b4a84a48a98910aa626953",
      "origin_story_identifier": "cloud:0babdfaca84c3865dc5749e64fde82f5:c7ab9dca268e2beb0e350df8150ed8e6",
      "options": {
        "mode": "message_only",
        "loop": false,
        "payload": {
          "mod_date": "<<DATE(search_for_ip_address.body.data.attributes.last_modification_date, \"%Y-%m-%d\", \"America/Vancouver\")>>",
          "last_analysis": "??"
        }
      },
      "reporting": {
        "time_saved_value": 0,
        "time_saved_unit": "minutes"
      },
      "monitoring": {
        "monitor_all_events": false,
        "monitor_failures": false,
        "monitor_no_events_emitted": null
      },
      "template": {
        "created_from_template_guid": null,
        "created_from_template_version": null,
        "template_tags": []
      },
      "width": null,
      "schedule": null
    },
    {
      "type": "Agents::HTTPRequestAgent",
      "name": "Search for IP address",
      "disabled": false,
      "description": "Find archived scans on urlscan.io by IPv4 or IPv6, either using an exact IP or a subnet definition. API search will find public scans performed by anyone as well as unlisted and private scans performed by you or your teams. \n\nURLscan.io query uses ElasticSearch syntax. This template allows you to search by any field supported by the search reference. To see all searchable fields, see the search API reference.\n\nLink to search API reference: https://urlscan.io/docs/search/\nLink to documentation: https://urlscan.io/docs/api/",
      "guid": "71c3bd8ea360570deeaf210943d774a9",
      "origin_story_identifier": "cloud:0babdfaca84c3865dc5749e64fde82f5:c7ab9dca268e2beb0e350df8150ed8e6",
      "options": {
        "url": "https://urlscan.io/api/v1/search/",
        "method": "get",
        "headers": {
          "API-Key": "<<INPUT.urlscan_credential>>"
        },
        "payload": "=LOCAL.final_payload",
        "local": {
          "optional_parameters": {
            "q": "=INPUT.query",
            "size": "=INPUT.size",
            "search_after": "=INPUT.search_after"
          },
          "final_payload": "=REJECT(\n  LOCAL.optional_parameters,\n  LAMBDA(\n    item,\n    OR(\n      item = NULL,\n      IF(\n        OR(\n          TYPE(item) = \"TrueClass\",\n          TYPE(item) = \"FalseClass\",\n          TYPE(item) = \"Integer\"\n        ),\n        IS_EMPTY(TEXT(item)),\n        IS_EMPTY(item)\n      )\n    )\n  )\n)"
        }
      },
      "reporting": {
        "time_saved_value": 0,
        "time_saved_unit": "minutes"
      },
      "monitoring": {
        "monitor_all_events": false,
        "monitor_failures": false,
        "monitor_no_events_emitted": null
      },
      "template": {
        "created_from_template_guid": "2288db6a340ab6b267227f3cf65c0f59e9e44f3893ac53bbb19ebd5ac0842eb6",
        "created_from_template_version": null,
        "template_tags": []
      },
      "width": null,
      "schedule": null
    },
    {
      "type": "Agents::FormAgent",
      "name": "Redirect Back to IOC Submission Page",
      "disabled": false,
      "description": null,
      "guid": "d385158d27cb5ba5f24c2e8d820b286a",
      "origin_story_identifier": "cloud:0babdfaca84c3865dc5749e64fde82f5:c7ab9dca268e2beb0e350df8150ed8e6",
      "options": {
        "fields": "",
        "mode": "redirect",
        "visibility": "tenant",
        "anonymize": false,
        "auto_submit": true,
        "page_logo": {
          "contents": "iVBORw0KGgoAAAANSUhEUgAAAFQAAAAYCAYAAABk8drWAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAARCSURBVHgB7VhLctpAEB1k7LVyA/kEgRMEn8BQ5e8qcALjE1icAPsEkJW/VeATwA1QTmDlBCE7l3/kPblbTIiMJcVOeaFXBRrN9Mz0vOnu6ZExBQoUKFCgwAdByX4ZDAbuw8PDwWw2a+LVk+rAcZxgZWWl02g0QpMSl5eXXRlnvLq62kLfqcmIi4uLZqlU+lwulztJ/aGvJ/p+39nZ6cu8R3j30c/f3t7umP8MRwtXV1df7+/vb6iMmZNJVJ6enppom5ydnbVNCpAIjENZF786Fn1kMgLE1PDocRz0HyTJQKe2zNOjMbBO3o1sZgS2Ybw29KqYd0ZEKMg8AGl980zAS3BhqV0Sv0Qmsho8/iCQi5T6XED/WtJmoj7W9/b2Vgk9gXUGWM+JtoF4H/VdFEdK/HvB4UIxuZ+2A2SPlykFayLhXkJ9z/wDsJlHaTZld3fXR4ho7O3tHWudRbyrxC+Ca+L4rxFuyXlJ7c7j4yOtKcuuuXd3d+0XJvMkZPwFWpm4cV64sLTBawuGB/UYus7Pz7vUB3NOYLGxV+EsuIHrT2ydITNCn5/sxyfaKdO0x02Qo8wNY7Yt52ChmeOKraAN2ZxlyBxLZb6xFCuvxWN4UE361PGYYn1egli0KSQJxIy42VIfso959rCehplFOYYUkY0MCJvn68C5CDUJLi2ho7msExVa3Pk0QL9veJxIuZ3W0pkZIMNYR3GodSBjA3VVlsUAPK1HprCOuqoQpmHGRV3FzNfcQvZQpSx06YjcFx3fMW8E7mBK0W6egwEk+ObZKkjqIO0hR1Ih/0vfYeGhpmAwgLpUX4OkMQv7+/shCNV0i+GtBrlYX5Kn2QLjNTeCMVvby6KkZ7IhsF/E6jyTDhqDfZMBJAHzUHHGP1cOuR8mJ05PTz0zPzs2MfZM20BgLAfCXGzmEAYTWbN4YRPy3JQxNusauo1V3hF3yopg4T1TbISSB3nSKLhZgL6HLDN8oLxp3ga8vPSTfnD3MTcTzw1ypeHASI6NX88+5Jy1tTWmF1luMRw8voHIKeeZbHBTHGCJgGseW4dU7pySrm3m6w62trZa9o/kQcdrkTNwaw9c8fZVhcV+oqtb5FY0DDgSTw7TKgKT7+gkhH0jyQK6Tt4kG+7eMtmMIAasLj6ELULqtsfw8oJ1jdA+YGjgLYvvPCcoR84Yc63+UWiIxucf78HiSsuUZFvLTpgF73rzSAI3FMS0MnQJtUCSmD/KdwvdGFfyygnb5NZIBGI8ShzTpwnzUcpaWU2oh1p8ytOVmDIsxIlImOkB0w/9AGFDFhaabJhCmcNlH0zgYoGxXHKxHW451LSF86vXQPdQ6sYqy7BmhYlofs7NPpImaZumR5y3jzVvsFLI0nW6ko9WRG6oaVg0v/nA0JCwjHhx1aktw3jGA+yF8dykr2ZisRVsZLg4XpIcSGWOG+b5ilagQIECBZLxG5sJ41WbSDouAAAAAElFTkSuQmCC\n",
          "display_logo": false,
          "name": "nites.jpeg",
          "type": "image/jpeg"
        },
        "page_width": "small",
        "pages_action_color": "#777FFF",
        "pages_appearance_mode": "light",
        "pages_background_color": "#F9F9F9",
        "url_identifier": "248f5943adf3060fa4e4cda1de754fc3",
        "redirect": "https://spring-water-5215.tines.com/pages/IOC-IP-Submission/",
        "auto_submit_time": "immediately"
      },
      "reporting": {
        "time_saved_value": 0,
        "time_saved_unit": "minutes"
      },
      "monitoring": {
        "monitor_all_events": false,
        "monitor_failures": false,
        "monitor_no_events_emitted": null
      },
      "template": {
        "created_from_template_guid": null,
        "created_from_template_version": null,
        "template_tags": []
      },
      "width": null
    },
    {
      "type": "Agents::EventTransformationAgent",
      "name": "Convert Last Modification Date with AI Automatic Mode",
      "disabled": false,
      "description": null,
      "guid": "026d8b43b5207906f3e053581b135776",
      "origin_story_identifier": "cloud:0babdfaca84c3865dc5749e64fde82f5:c7ab9dca268e2beb0e350df8150ed8e6",
      "options": {
        "mode": "automatic",
        "input": "=search_for_ip_address.body.data.attributes.last_modification_date",
        "guidance": "Convert time to Pacific Standard Time in the format YYYY-MM-DD.",
        "language": "Python",
        "script": "import datetime\nimport pytz\n\ndef main(input: int) -> str:\n    \"\"\"\n    Converts the given Unix timestamp to Pacific Standard Time (PST) and returns the date in the format YYYY-MM-DD.\n    \"\"\"\n    pst = pytz.timezone('US/Pacific')\n    dt = datetime.datetime.fromtimestamp(input, tz=pst)\n    return dt.strftime('%Y-%m-%d')",
        "requirements": "pytz==2024.2"
      },
      "reporting": {
        "time_saved_value": 0,
        "time_saved_unit": "minutes"
      },
      "monitoring": {
        "monitor_all_events": false,
        "monitor_failures": false,
        "monitor_no_events_emitted": null
      },
      "template": {
        "created_from_template_guid": null,
        "created_from_template_version": null,
        "template_tags": []
      },
      "width": null,
      "schedule": null
    },
    {
      "type": "Agents::LLMAgent",
      "name": "Analyze alert",
      "disabled": false,
      "description": "Analyze an incoming security alert and make recommendations.",
      "guid": "06ff909fcef677e3e7731d8815f8920c",
      "origin_story_identifier": "cloud:182d03829f868533adca5fc807c21091:cb4d5d7971844bea37ed48057f607b34",
      "options": {
        "prompt": "Act as an expert cybersecurity engineer analyzing the following alert. Respond with some recommended actions for handling the alert, along with a risk rating from 0-10 and explanation. \n\n\nRespond with JSON with 3 fields: \"recommendations\", \"risk_rating\" and \"risk_explanation\". Only use data from the event, do not generate any example data or make any assumptions.\n\nEvent data:\n<<data_example.details>>"
      },
      "reporting": {
        "time_saved_value": 0,
        "time_saved_unit": "minutes"
      },
      "monitoring": {
        "monitor_all_events": false,
        "monitor_failures": false,
        "monitor_no_events_emitted": null
      },
      "template": {
        "created_from_template_guid": "329eb299fe36dc55cb9b52e75cf399cad4a59aecfe47a21bbfec1d6d42fc275a",
        "created_from_template_version": null,
        "template_tags": []
      },
      "width": null,
      "schedule": null
    },
    {
      "type": "Agents::EventTransformationAgent",
      "name": "Data example",
      "disabled": false,
      "description": null,
      "guid": "cb00f78a3a194c50a88770ae8fbeaded",
      "origin_story_identifier": "cloud:182d03829f868533adca5fc807c21091:cb4d5d7971844bea37ed48057f607b34",
      "options": {
        "mode": "message_only",
        "loop": false,
        "payload": {
          "details": [
            {
              "id": "1",
              "type": "SQL Injection Attempt",
              "request": "GET /search?q=1'%20OR%20'1'='1",
              "source_ip": "192.168.1.10",
              "timestamp": "2024-12-09T10:15:00Z"
            },
            {
              "id": "2",
              "type": "Suspicious User Agent",
              "request": "POST /login",
              "user_agent": "sqlmap/1.5.2",
              "source_ip": "192.168.1.11",
              "timestamp": "2024-12-09T10:20:00Z"
            },
            {
              "id": "3",
              "type": "Directory Traversal Attempt",
              "request": "GET /../../../etc/passwd",
              "source_ip": "192.168.1.12",
              "timestamp": "2024-12-09T10:25:00Z"
            },
            {
              "id": "4",
              "type": "Excessive Requests from Single IP",
              "request_count": 500,
              "source_ip": "192.168.1.13",
              "timestamp": "2024-12-09T10:30:00Z"
            },
            {
              "id": "5",
              "type": "Malformed Request",
              "request": "POST /api/data",
              "content_length": "10,000,000",
              "source_ip": "192.168.1.14",
              "timestamp": "2024-12-09T10:35:00Z"
            }
          ]
        }
      },
      "reporting": {
        "time_saved_value": 0,
        "time_saved_unit": "minutes"
      },
      "monitoring": {
        "monitor_all_events": false,
        "monitor_failures": false,
        "monitor_no_events_emitted": null
      },
      "template": {
        "created_from_template_guid": null,
        "created_from_template_version": null,
        "template_tags": []
      },
      "width": null,
      "schedule": null
    },
    {
      "type": "Agents::HTTPRequestAgent",
      "name": "Search for IP Address",
      "disabled": false,
      "description": "Search for an IP Address in VirusTotal. Report returns asn information, download samples, resolutions, detected and undetected urls etc.\n\nLink to documentation: https://virustotal.readme.io/reference/ip-info",
      "guid": "e3a8311c24c4a937b9be0bd0357f370d",
      "origin_story_identifier": "cloud:0babdfaca84c3865dc5749e64fde82f5:c7ab9dca268e2beb0e350df8150ed8e6",
      "options": {
        "url": "https://www.virustotal.com/api/v3/ip_addresses/<<INPUT.ip_address>>",
        "method": "get",
        "headers": {
          "x-apikey": "<<INPUT.virustotal_credential>>"
        }
      },
      "reporting": {
        "time_saved_value": 0,
        "time_saved_unit": "minutes"
      },
      "monitoring": {
        "monitor_all_events": false,
        "monitor_failures": false,
        "monitor_no_events_emitted": null
      },
      "template": {
        "created_from_template_guid": "6ec39048bdf2b511750207e63fe891d5bc9584dc3898999be867f46854170db4",
        "created_from_template_version": null,
        "template_tags": []
      },
      "width": null,
      "schedule": null
    },
    {
      "type": "Agents::HTTPRequestAgent",
      "name": "Append element to IP Sunset List",
      "disabled": false,
      "description": "Append a string or an array to a resource. If the resource has a test value this can be modified by using the is_test parameter.\n\nLink to API documentation: https://www.tines.com/api/resources/append-element",
      "guid": "ec580a14ba1ed274a52c4924a86163a1",
      "origin_story_identifier": "cloud:0babdfaca84c3865dc5749e64fde82f5:efabe1c152f0445f920b8e6e3c3d0118",
      "options": {
        "url": "https://<<INPUT.tenant_domain>>/api/v1/global_resources/<<INPUT.resource_id>>/append",
        "method": "post",
        "headers": {
          "Authorization": "Bearer <<INPUT.tines_credential>>"
        },
        "content_type": "application_json",
        "local": {
          "all_parameters": {
            "value": "=DEFAULT(INPUT.text_value, INPUT.array_value)",
            "is_test": "=INPUT.is_test_resource"
          },
          "final_payload": "=REJECT(\n  LOCAL.all_parameters,\n  LAMBDA(\n    item,\n    OR(\n      item = NULL,\n      IF(\n        OR(\n          TYPE(item) = \"TrueClass\",\n          TYPE(item) = \"FalseClass\",\n          TYPE(item) = \"Integer\"\n        ),\n        IS_EMPTY(TEXT(item)),\n        IS_EMPTY(item)\n      )\n    )\n  )\n)"
        },
        "payload": "=LOCAL.final_payload"
      },
      "reporting": {
        "time_saved_value": 0,
        "time_saved_unit": "minutes"
      },
      "monitoring": {
        "monitor_all_events": false,
        "monitor_failures": false,
        "monitor_no_events_emitted": null
      },
      "template": {
        "created_from_template_guid": "b40e331f2e157852280d1116aff9f928555943a8fb098475fb5e987014e3e238",
        "created_from_template_version": null,
        "template_tags": []
      },
      "width": null,
      "schedule": null
    },
    {
      "type": "Agents::EventTransformationAgent",
      "name": "Create IOC Object",
      "disabled": false,
      "description": null,
      "guid": "401c553acd871e6f6ca0c104a33a1afb",
      "origin_story_identifier": "cloud:0babdfaca84c3865dc5749e64fde82f5:efabe1c152f0445f920b8e6e3c3d0118",
      "options": {
        "mode": "message_only",
        "loop": false,
        "payload": {
          "ioc_object": "=OBJECT(\"ip\", explode_ips.ip,\n\"date\", DATE(\"now\", \"%Y-%m-%d\"))"
        }
      },
      "reporting": {
        "time_saved_value": 0,
        "time_saved_unit": "minutes"
      },
      "monitoring": {
        "monitor_all_events": false,
        "monitor_failures": false,
        "monitor_no_events_emitted": null
      },
      "template": {
        "created_from_template_guid": null,
        "created_from_template_version": null,
        "template_tags": []
      },
      "width": null,
      "schedule": null
    },
    {
      "type": "Agents::EventTransformationAgent",
      "name": "Filter IP Sunset List - 21 days old - Automatic Mode",
      "disabled": false,
      "description": null,
      "guid": "ff3e14bcbec6ed9948e5c53af400bc35",
      "origin_story_identifier": "cloud:0babdfaca84c3865dc5749e64fde82f5:c7ab9dca268e2beb0e350df8150ed8e6",
      "options": {
        "mode": "automatic",
        "input": "=RESOURCE.ip_sunset_list",
        "guidance": "Extract IPs older than 21 days.",
        "language": "Python",
        "script": "from datetime import datetime, timedelta\n\ndef main(input):\n    today = datetime.now()\n    cutoff_date = today - timedelta(days=21)\n    \n    old_ips = []\n    for item in input:\n        ip = item.get('ip')\n        date_str = item.get('date')\n        date = datetime.strptime(date_str, '%Y-%m-%d')\n        if date < cutoff_date:\n            old_ips.append(ip)\n    \n    return old_ips"
      },
      "reporting": {
        "time_saved_value": 0,
        "time_saved_unit": "minutes"
      },
      "monitoring": {
        "monitor_all_events": false,
        "monitor_failures": false,
        "monitor_no_events_emitted": null
      },
      "template": {
        "created_from_template_guid": null,
        "created_from_template_version": null,
        "template_tags": []
      },
      "width": null,
      "schedule": null
    },
    {
      "type": "Agents::EventTransformationAgent",
      "name": "Explode IPs",
      "disabled": false,
      "description": null,
      "guid": "057d6fd30b2118f1df5669d89d46c454",
      "origin_story_identifier": "cloud:0babdfaca84c3865dc5749e64fde82f5:c7ab9dca268e2beb0e350df8150ed8e6",
      "options": {
        "mode": "explode",
        "path": "=filter_ip_sunset_list_21_days_old_automatic_mode.output",
        "to": "ip",
        "limit": "500"
      },
      "reporting": {
        "time_saved_value": 0,
        "time_saved_unit": "minutes"
      },
      "monitoring": {
        "monitor_all_events": false,
        "monitor_failures": false,
        "monitor_no_events_emitted": null
      },
      "template": {
        "created_from_template_guid": null,
        "created_from_template_version": null,
        "template_tags": []
      },
      "width": null,
      "schedule": null
    },
    {
      "type": "Agents::EventTransformationAgent",
      "name": "Filter IP Sunset List - 21 days old - Filter Function",
      "disabled": false,
      "description": null,
      "guid": "e676ec234f6ca55790020d035f1c6608",
      "origin_story_identifier": "cloud:0babdfaca84c3865dc5749e64fde82f5:c7ab9dca268e2beb0e350df8150ed8e6",
      "options": {
        "mode": "message_only",
        "loop": false,
        "payload": {
          "data": "=FILTER(RESOURCE.ip_sunset_list, LAMBDA(element, (DATE_DIFF(element.date, DATE(\"Today\", \"%Y%m%dT\")) |> %.days) > 21))"
        }
      },
      "reporting": {
        "time_saved_value": 0,
        "time_saved_unit": "minutes"
      },
      "monitoring": {
        "monitor_all_events": false,
        "monitor_failures": false,
        "monitor_no_events_emitted": null
      },
      "template": {
        "created_from_template_guid": null,
        "created_from_template_version": null,
        "template_tags": []
      },
      "width": null,
      "schedule": null
    },
    {
      "type": "Agents::EventTransformationAgent",
      "name": "Explode IPs",
      "disabled": false,
      "description": null,
      "guid": "0d1db02216995e766e560ab81183a28d",
      "origin_story_identifier": "cloud:0babdfaca84c3865dc5749e64fde82f5:c7ab9dca268e2beb0e350df8150ed8e6",
      "options": {
        "mode": "explode",
        "path": "=extract_ips.output",
        "to": "ip",
        "limit": "500"
      },
      "reporting": {
        "time_saved_value": 0,
        "time_saved_unit": "minutes"
      },
      "monitoring": {
        "monitor_all_events": false,
        "monitor_failures": false,
        "monitor_no_events_emitted": null
      },
      "template": {
        "created_from_template_guid": null,
        "created_from_template_version": null,
        "template_tags": []
      },
      "width": null,
      "schedule": null
    },
    {
      "type": "Agents::EventTransformationAgent",
      "name": "Extract IPs",
      "disabled": false,
      "description": null,
      "guid": "3007936219b4794a3fb9e9fc71905caf",
      "origin_story_identifier": "cloud:0babdfaca84c3865dc5749e64fde82f5:c7ab9dca268e2beb0e350df8150ed8e6",
      "options": {
        "mode": "automatic",
        "input": "=filter_ip_sunset_list_21_days_old_filter_function.data",
        "guidance": "Extract the value from the ip key",
        "language": "Python",
        "script": "def main(input):\n    ips = [item.get('ip') for item in input]\n    return ips"
      },
      "reporting": {
        "time_saved_value": 0,
        "time_saved_unit": "minutes"
      },
      "monitoring": {
        "monitor_all_events": false,
        "monitor_failures": false,
        "monitor_no_events_emitted": null
      },
      "template": {
        "created_from_template_guid": null,
        "created_from_template_version": null,
        "template_tags": []
      },
      "width": null,
      "schedule": null
    },
    {
      "type": "Agents::HTTPRequestAgent",
      "name": "Remove element from a resource",
      "disabled": false,
      "description": "Remove a top level element from an array or key from an object in a resource. The request returns the removed item. If the resource has a test value this can be modified by using the is_test parameter.\n\nLink to API documentation: https://www.tines.com/api/resources/remove-element",
      "guid": "133ed74ef5f8f8804b61a2bf1cd7646a",
      "origin_story_identifier": "cloud:0babdfaca84c3865dc5749e64fde82f5:c7ab9dca268e2beb0e350df8150ed8e6",
      "options": {
        "url": "https://<<INPUT.tenant_domain>>/api/v1/global_resources/<<INPUT.resource_id>>/remove",
        "method": "post",
        "headers": {
          "Authorization": "Bearer <<INPUT.tines_credential>>"
        },
        "content_type": "application_json",
        "local": {
          "all_parameters": {
            "key": "=INPUT.key",
            "index": "=INPUT.index",
            "is_test": "=INPUT.is_test_resource"
          },
          "final_payload": "=REJECT(\n  LOCAL.all_parameters,\n  LAMBDA(\n    item,\n    OR(\n      item = NULL,\n      IF(\n        OR(\n          TYPE(item) = \"TrueClass\",\n          TYPE(item) = \"FalseClass\",\n          TYPE(item) = \"Integer\"\n        ),\n        IS_EMPTY(TEXT(item)),\n        IS_EMPTY(item)\n      )\n    )\n  )\n)"
        },
        "payload": "=LOCAL.final_payload"
      },
      "reporting": {
        "time_saved_value": 0,
        "time_saved_unit": "minutes"
      },
      "monitoring": {
        "monitor_all_events": false,
        "monitor_failures": false,
        "monitor_no_events_emitted": null
      },
      "template": {
        "created_from_template_guid": "fe7850ca94e4fe0672c498843ba254f6eb1499494b39fd2800cbfda6477bfe7c",
        "created_from_template_version": null,
        "template_tags": []
      },
      "width": null,
      "schedule": null
    },
    {
      "type": "Agents::EventTransformationAgent",
      "name": "Implode",
      "disabled": false,
      "description": null,
      "guid": "a608f57fc32b4a41d5ac79ca7fdec78f",
      "origin_story_identifier": "cloud:0babdfaca84c3865dc5749e64fde82f5:c7ab9dca268e2beb0e350df8150ed8e6",
      "options": {
        "mode": "implode",
        "item_path": "=explode_ips.ip",
        "guid_path": "=explode_ips.guid",
        "size_path": "=explode_ips.size"
      },
      "reporting": {
        "time_saved_value": 0,
        "time_saved_unit": "minutes"
      },
      "monitoring": {
        "monitor_all_events": false,
        "monitor_failures": false,
        "monitor_no_events_emitted": null
      },
      "template": {
        "created_from_template_guid": null,
        "created_from_template_version": null,
        "template_tags": []
      },
      "width": null,
      "schedule": null
    },
    {
      "type": "Agents::EventTransformationAgent",
      "name": "Throttle",
      "disabled": false,
      "description": null,
      "guid": "f9d71d2748e9ece23ee149d4fcbfc914",
      "origin_story_identifier": "cloud:0babdfaca84c3865dc5749e64fde82f5:c7ab9dca268e2beb0e350df8150ed8e6",
      "options": {
        "mode": "throttle",
        "interval": "minute",
        "capacity": "30",
        "events_per_run": 1
      },
      "reporting": {
        "time_saved_value": 0,
        "time_saved_unit": "minutes"
      },
      "monitoring": {
        "monitor_all_events": false,
        "monitor_failures": false,
        "monitor_no_events_emitted": null
      },
      "template": {
        "created_from_template_guid": null,
        "created_from_template_version": null,
        "template_tags": []
      },
      "width": null
    },
    {
      "type": "Agents::HTTPRequestAgent",
      "name": "Remove element from a resource",
      "disabled": false,
      "description": "Remove a top level element from an array or key from an object in a resource. The request returns the removed item. If the resource has a test value this can be modified by using the is_test parameter.\n\nLink to API documentation: https://www.tines.com/api/resources/remove-element",
      "guid": "fc014060ecc5774236d10f9107c720a6",
      "origin_story_identifier": "cloud:0babdfaca84c3865dc5749e64fde82f5:c7ab9dca268e2beb0e350df8150ed8e6",
      "options": {
        "url": "https://<<INPUT.tenant_domain>>/api/v1/global_resources/<<INPUT.resource_id>>/remove",
        "method": "post",
        "headers": {
          "Authorization": "Bearer <<INPUT.tines_credential>>"
        },
        "content_type": "application_json",
        "local": {
          "all_parameters": {
            "key": "=INPUT.key",
            "index": "=INPUT.index",
            "is_test": "=INPUT.is_test_resource"
          },
          "final_payload": "=REJECT(\n  LOCAL.all_parameters,\n  LAMBDA(\n    item,\n    OR(\n      item = NULL,\n      IF(\n        OR(\n          TYPE(item) = \"TrueClass\",\n          TYPE(item) = \"FalseClass\",\n          TYPE(item) = \"Integer\"\n        ),\n        IS_EMPTY(TEXT(item)),\n        IS_EMPTY(item)\n      )\n    )\n  )\n)"
        },
        "payload": "=LOCAL.final_payload"
      },
      "reporting": {
        "time_saved_value": 0,
        "time_saved_unit": "minutes"
      },
      "monitoring": {
        "monitor_all_events": false,
        "monitor_failures": false,
        "monitor_no_events_emitted": null
      },
      "template": {
        "created_from_template_guid": "fe7850ca94e4fe0672c498843ba254f6eb1499494b39fd2800cbfda6477bfe7c",
        "created_from_template_version": null,
        "template_tags": []
      },
      "width": null,
      "schedule": null
    },
    {
      "type": "Agents::EventTransformationAgent",
      "name": "Implode",
      "disabled": false,
      "description": null,
      "guid": "9c589b85db36b845024e0cb146263235",
      "origin_story_identifier": "cloud:0babdfaca84c3865dc5749e64fde82f5:c7ab9dca268e2beb0e350df8150ed8e6",
      "options": {
        "mode": "implode",
        "item_path": "=explode_ips.ip",
        "guid_path": "=explode_ips.guid",
        "size_path": "=explode_ips.size"
      },
      "reporting": {
        "time_saved_value": 0,
        "time_saved_unit": "minutes"
      },
      "monitoring": {
        "monitor_all_events": false,
        "monitor_failures": false,
        "monitor_no_events_emitted": null
      },
      "template": {
        "created_from_template_guid": null,
        "created_from_template_version": null,
        "template_tags": []
      },
      "width": null,
      "schedule": null
    },
    {
      "type": "Agents::EventTransformationAgent",
      "name": "Throttle",
      "disabled": false,
      "description": null,
      "guid": "088ff81cd54c599f813f49a7765913aa",
      "origin_story_identifier": "cloud:0babdfaca84c3865dc5749e64fde82f5:c7ab9dca268e2beb0e350df8150ed8e6",
      "options": {
        "mode": "throttle",
        "interval": "minute",
        "capacity": "30",
        "events_per_run": 1
      },
      "reporting": {
        "time_saved_value": 0,
        "time_saved_unit": "minutes"
      },
      "monitoring": {
        "monitor_all_events": false,
        "monitor_failures": false,
        "monitor_no_events_emitted": null
      },
      "template": {
        "created_from_template_guid": null,
        "created_from_template_version": null,
        "template_tags": []
      },
      "width": null
    },
    {
      "type": "Agents::EventTransformationAgent",
      "name": "Implode IPs",
      "disabled": false,
      "description": null,
      "guid": "41858f43f26b75df77e2c00af076d4e0",
      "origin_story_identifier": "cloud:0babdfaca84c3865dc5749e64fde82f5:c7ab9dca268e2beb0e350df8150ed8e6",
      "options": {
        "mode": "implode",
        "item_path": "=explode_ips.ip",
        "guid_path": "=explode_ips.guid",
        "size_path": "=explode_ips.size"
      },
      "reporting": {
        "time_saved_value": 0,
        "time_saved_unit": "minutes"
      },
      "monitoring": {
        "monitor_all_events": false,
        "monitor_failures": false,
        "monitor_no_events_emitted": null
      },
      "template": {
        "created_from_template_guid": null,
        "created_from_template_version": null,
        "template_tags": []
      },
      "width": null,
      "schedule": null
    },
    {
      "type": "Agents::EventTransformationAgent",
      "name": "Event Transform Action",
      "disabled": false,
      "description": null,
      "guid": "673c3de96b8bc2f0e6225b9a206a57ab",
      "origin_story_identifier": "cloud:0babdfaca84c3865dc5749e64fde82f5:c7ab9dca268e2beb0e350df8150ed8e6",
      "options": {
        "mode": "message_only",
        "loop": false,
        "payload": {
          "message": "This is an automatically generated message from Tines"
        }
      },
      "reporting": {
        "time_saved_value": 0,
        "time_saved_unit": "minutes"
      },
      "monitoring": {
        "monitor_all_events": false,
        "monitor_failures": false,
        "monitor_no_events_emitted": null
      },
      "template": {
        "created_from_template_guid": null,
        "created_from_template_version": null,
        "template_tags": []
      },
      "width": null,
      "schedule": null
    },
    {
      "type": "Agents::EmailAgent",
      "name": "Send Email Action",
      "disabled": false,
      "description": null,
      "guid": "321fb97bcdc525bcebf3495632ee3ae5",
      "origin_story_identifier": "cloud:0babdfaca84c3865dc5749e64fde82f5:c7ab9dca268e2beb0e350df8150ed8e6",
      "options": {
        "recipients": "thomasedwardpower@gmail.com",
        "reply_to": "thomasedwardpower@gmail.com",
        "sender_name": "Tines IOC Management Workflow",
        "subject": "Malicious IOCs",
        "body": "A real email body could go here",
        "advanced_html": true,
        "attachments": [
          {
            "filename": "<<TODAY()>>_Malicious_IOCs.csv",
            "base64encodedcontents": "<<BASE64_ENCODE(objects_to_csv_malicious_ips.message)>>",
            "content_type": "auto"
          }
        ]
      },
      "reporting": {
        "time_saved_value": 0,
        "time_saved_unit": "minutes"
      },
      "monitoring": {
        "monitor_all_events": false,
        "monitor_failures": false,
        "monitor_no_events_emitted": null
      },
      "template": {
        "created_from_template_guid": null,
        "created_from_template_version": null,
        "template_tags": []
      },
      "width": null,
      "schedule": null
    },
    {
      "type": "Agents::EventTransformationAgent",
      "name": "Objects to CSV - Malicious IPs",
      "disabled": false,
      "description": null,
      "guid": "4be852bd0b5c54a1d48ce02bf85dbff8",
      "origin_story_identifier": "cloud:0babdfaca84c3865dc5749e64fde82f5:c7ab9dca268e2beb0e350df8150ed8e6",
      "options": {
        "mode": "message_only",
        "loop": false,
        "payload": {
          "message": "=OBJECTS_TO_CSV(RESOURCE.ip_sunset_list)"
        }
      },
      "reporting": {
        "time_saved_value": 0,
        "time_saved_unit": "minutes"
      },
      "monitoring": {
        "monitor_all_events": false,
        "monitor_failures": false,
        "monitor_no_events_emitted": null
      },
      "template": {
        "created_from_template_guid": null,
        "created_from_template_version": null,
        "template_tags": []
      },
      "width": null,
      "schedule": null
    }
  ],
  "diagram_notes": [
    {
      "content": "# Goals\n- Learn how to construct a Tines Page for submitting IOCs\n- Learn about Extract Mode & the MAP function to parse a csv.\n- Learn how to search Tines Template library to use preconfigure Tines Actions, such as searching an IP address in VirusTotal & URLScan.io.\n- Learn about the Tines AI action.\n- Learn about the Send To Story action/webhooks",
      "position": [
        -120,
        -240
      ],
      "guid": "ef540991e6cb4eec99991c79f09a9dc5",
      "width": 270
    },
    {
      "content": "Helpful Regex for checking the validity of domain, ipv4, sha256, and email IOCs",
      "position": [
        -120,
        405
      ],
      "guid": "573f7bd7eb5ca56ea909e82964581f11",
      "width": 270
    },
    {
      "content": "# Exercise 2 - Build your own Tines webform for IOC submission",
      "position": [
        195,
        1095
      ],
      "guid": "c5a574fd169293596a63db2e43d6cb6a",
      "width": 270
    },
    {
      "content": "# AI LLM To Analyze Alerts to determine which need follow up",
      "position": [
        -465,
        615
      ],
      "guid": "499ed41a5c3f64542d45be1953cf3b5b",
      "width": 270
    },
    {
      "content": "# Requirements\n-  Sign up for a free personal API key at VirusTotal and URLScan.io.\n\n- Create a Tines Resource called ip_sunset_list\n\n ",
      "position": [
        -120,
        0
      ],
      "guid": "16ba3386ee75f544768e2d8ccbfcc281",
      "width": 270
    },
    {
      "content": "# Technical Resources\n- [Tines Pages](https://www.tines.com/docs/pages/)\n\n- [Tines Date Function](https://www.tines.com/docs/formulas/functions/date/)\n\n- [Tines Map Function](https://www.tines.com/docs/formulas/functions/map/)\n\n- [Tines CSV Parse To Objects Function](https://www.tines.com/docs/formulas/functions/csv-parse-to-objects/)\n\n- [Tines Base64_Decode Function](https://www.tines.com/docs/formulas/functions/base64-decode/)\n\n- [Tines Extract Mode](https://www.tines.com/docs/actions/types/event-transformation/extract/)\n\n- [Tines Explode Mode](https://www.tines.com/docs/actions/types/event-transformation/explode/)\n\n- [Tines Automatic Mode](https://www.tines.com/docs/actions/types/event-transformation/automatic/#example-configuration-options)\n\n- [Tips for Automatic Mode](https://explained.tines.com/en/articles/9369122-tips-for-automatic-mode)\n\n- [Troubleshooting Tips in Pages & HTTP Request action](https://explained.tines.com/en/articles/9889226-example-approach-story-troubleshooting)\n\n- [Tines Today Function](https://www.tines.com/docs/formulas/functions/today/)\n\n- [Regex Editor](https://rubular.com/)",
      "position": [
        -120,
        135
      ],
      "guid": "ff3518e490cb368a34d930e407c86c59",
      "width": 269
    },
    {
      "content": "# *Templates*",
      "position": [
        -360,
        420
      ],
      "guid": "0d02589a4b353f4ae140cb3ea6af43d2",
      "width": 180
    },
    {
      "content": "# IOC Sunsetting:  AI Automatic Mode vs Filter",
      "position": [
        1140,
        -240
      ],
      "guid": "0b243b2862d5ad5132c1d3033a0c43e3",
      "width": 356
    }
  ],
  "links": [
    {
      "source": 0,
      "receiver": 1
    },
    {
      "source": 0,
      "receiver": 12
    },
    {
      "source": 1,
      "receiver": 2
    },
    {
      "source": 1,
      "receiver": 3,
      "link_type": "secondary"
    },
    {
      "source": 2,
      "receiver": 5
    },
    {
      "source": 3,
      "receiver": 9
    },
    {
      "source": 5,
      "receiver": 8
    },
    {
      "source": 6,
      "receiver": 7
    },
    {
      "source": 6,
      "receiver": 10
    },
    {
      "source": 6,
      "receiver": 13
    },
    {
      "source": 6,
      "receiver": 31
    },
    {
      "source": 7,
      "receiver": 18
    },
    {
      "source": 7,
      "receiver": 30,
      "link_type": "secondary"
    },
    {
      "source": 8,
      "receiver": 6
    },
    {
      "source": 9,
      "receiver": 8
    },
    {
      "source": 15,
      "receiver": 14
    },
    {
      "source": 17,
      "receiver": 30
    },
    {
      "source": 18,
      "receiver": 17
    },
    {
      "source": 19,
      "receiver": 20
    },
    {
      "source": 20,
      "receiver": 26
    },
    {
      "source": 21,
      "receiver": 23
    },
    {
      "source": 22,
      "receiver": 29
    },
    {
      "source": 23,
      "receiver": 22
    },
    {
      "source": 24,
      "receiver": 25
    },
    {
      "source": 26,
      "receiver": 24
    },
    {
      "source": 27,
      "receiver": 28
    },
    {
      "source": 29,
      "receiver": 27
    },
    {
      "source": 30,
      "receiver": 33
    },
    {
      "source": 33,
      "receiver": 32
    }
  ],
  "diagram_layout": "{\"020d4b8cceed45713c205da9feac1783\":[450,-195],\"5e23b9d6a3c747bc9d4c2bc2f5708f58\":[450,165],\"5a05cbd7cb273afe524e4e01f451757e\":[330,240],\"78ea80d7152301db4379ae88c66eca0f\":[585,240],\"58d6b736851c40f4c8736554728ea13f\":[-120,480],\"f87763ac857e0e2454d003f167f7860b\":[330,330],\"1348fa66f3dfa0892fc26529496c8cc3\":[450,480],\"47f3100b599674fd12cfdefc2ee565ee\":[450,585],\"15a1d0ea2f79420206e077792b20abe7\":[450,405],\"67c0a7cbfc4e778893e820c1c5afbd0f\":[585,330],\"e37b6dba48b4a84a48a98910aa626953\":[210,555],\"71c3bd8ea360570deeaf210943d774a9\":[-360,480],\"d385158d27cb5ba5f24c2e8d820b286a\":[780,75],\"026d8b43b5207906f3e053581b135776\":[630,555],\"06ff909fcef677e3e7731d8815f8920c\":[-360,765],\"cb00f78a3a194c50a88770ae8fbeaded\":[-360,705],\"e3a8311c24c4a937b9be0bd0357f370d\":[-360,540],\"ec580a14ba1ed274a52c4924a86163a1\":[450,765],\"401c553acd871e6f6ca0c104a33a1afb\":[450,690],\"ff3e14bcbec6ed9948e5c53af400bc35\":[1125,-150],\"057d6fd30b2118f1df5669d89d46c454\":[1125,-60],\"e676ec234f6ca55790020d035f1c6608\":[1410,-150],\"0d1db02216995e766e560ab81183a28d\":[1410,0],\"3007936219b4794a3fb9e9fc71905caf\":[1410,-75],\"133ed74ef5f8f8804b61a2bf1cd7646a\":[1125,90],\"a608f57fc32b4a41d5ac79ca7fdec78f\":[1125,195],\"f9d71d2748e9ece23ee149d4fcbfc914\":[1125,15],\"fc014060ecc5774236d10f9107c720a6\":[1410,150],\"9c589b85db36b845024e0cb146263235\":[1410,225],\"088ff81cd54c599f813f49a7765913aa\":[1410,75],\"41858f43f26b75df77e2c00af076d4e0\":[450,855],\"673c3de96b8bc2f0e6225b9a206a57ab\":[885,555],\"321fb97bcdc525bcebf3495632ee3ae5\":[450,990],\"4be852bd0b5c54a1d48ce02bf85dbff8\":[450,930]}",
  "send_to_story_enabled": false,
  "entry_agent_guid": null,
  "exit_agent_guids": [],
  "api_entry_action_guids": [],
  "api_exit_action_guids": [],
  "keep_events_for": 86400,
  "reporting_status": true,
  "send_to_story_access": null,
  "story_library_metadata": {},
  "parent_only_send_to_story": false,
  "monitor_failures": false,
  "send_to_stories": [],
  "recipients": [
    "thomasedwardpower@gmail.com"
  ],
  "synchronous_webhooks_enabled": false,
  "send_to_story_access_source": 0,
  "send_to_story_skill_use_requires_confirmation": true,
  "pages": [
    {
      "containers": [
        {
          "guid": "251c5b9fb1971b6727e8576f7cbefc39",
          "ranking": 0,
          "category": 0
        },
        {
          "guid": "82d3d34ef1b3afb61b916a82337d6c6b",
          "ranking": 1,
          "category": 0
        },
        {
          "guid": "1b6dee5e1695824d7156adc5a1fb60ad",
          "ranking": 2,
          "category": 0
        },
        {
          "guid": "c09e4ef3336a9ecff46083545d72e5cb",
          "ranking": 3,
          "category": 0
        },
        {
          "guid": "7bb253c3246b71aee0770bcf346c2b21",
          "ranking": 4,
          "category": 0
        }
      ],
      "conditions": [],
      "fields": [
        {
          "guid": "7970e9818c12ad385669a64780acbb0b",
          "name": "Paragraph",
          "description": "",
          "required": false,
          "type": "PARAGRAPH",
          "multi_select": false,
          "options": [
            "Option 1",
            "Option 2"
          ],
          "ranking": 0,
          "max_characters": null,
          "default_value": null,
          "content": "Use this submission page to analyze IOCs",
          "validation_pattern": null,
          "style": "primary",
          "container_guid": "82d3d34ef1b3afb61b916a82337d6c6b",
          "graph_type": 0,
          "graph_direction": "HORIZONTAL",
          "date_mode": "DATE",
          "store_value_as": "",
          "allow_table_row_selection": false,
          "is_searchable": false,
          "height": null,
          "image_fit": "CONTAIN"
        },
        {
          "guid": "9109c94656ab52c266c1da7cbe9a3a6b",
          "name": "Button",
          "description": "",
          "required": false,
          "type": "BUTTON",
          "multi_select": false,
          "options": [
            "Option 1",
            "Option 2"
          ],
          "ranking": 0,
          "max_characters": null,
          "default_value": null,
          "content": "Submit",
          "validation_pattern": null,
          "style": "primary",
          "container_guid": "7bb253c3246b71aee0770bcf346c2b21",
          "graph_type": 0,
          "graph_direction": "HORIZONTAL",
          "date_mode": "DATE",
          "store_value_as": "",
          "allow_table_row_selection": false,
          "is_searchable": false,
          "height": null,
          "image_fit": "CONTAIN"
        },
        {
          "guid": "ad11fc445d26166573ad5d3ea9b1d15b",
          "name": "Heading",
          "description": "",
          "required": false,
          "type": "TITLE",
          "multi_select": false,
          "options": [
            "Option 1",
            "Option 2"
          ],
          "ranking": 0,
          "max_characters": null,
          "default_value": null,
          "content": "IPv4 IOC Submission Page",
          "validation_pattern": null,
          "style": "primary",
          "container_guid": "251c5b9fb1971b6727e8576f7cbefc39",
          "graph_type": 0,
          "graph_direction": "HORIZONTAL",
          "date_mode": "DATE",
          "store_value_as": "",
          "allow_table_row_selection": false,
          "is_searchable": false,
          "height": null,
          "image_fit": "CONTAIN"
        },
        {
          "guid": "0fcb52e592b889e58493e30973e8c9f5",
          "name": "Upload CSV",
          "description": "Upload a csv with the header ip along with each IPv4 address on a single line.",
          "required": false,
          "type": "FILE_UPLOAD",
          "multi_select": false,
          "options": [
            "Option 1",
            "Option 2"
          ],
          "ranking": 0,
          "max_characters": null,
          "default_value": null,
          "content": null,
          "validation_pattern": null,
          "style": "primary",
          "container_guid": "1b6dee5e1695824d7156adc5a1fb60ad",
          "graph_type": 0,
          "graph_direction": "HORIZONTAL",
          "date_mode": "DATE",
          "store_value_as": "=password_value",
          "allow_table_row_selection": false,
          "is_searchable": false,
          "height": null,
          "image_fit": "CONTAIN"
        },
        {
          "guid": "a5f40b3b642eb00268f6af84a8486c88",
          "name": "IPv4 IOCs",
          "description": "For multiple submissions, use comma separated values.",
          "required": false,
          "type": "SHORT_TEXT",
          "multi_select": false,
          "options": [
            "Option 1",
            "Option 2"
          ],
          "ranking": 0,
          "max_characters": null,
          "default_value": null,
          "content": null,
          "validation_pattern": null,
          "style": "primary",
          "container_guid": "c09e4ef3336a9ecff46083545d72e5cb",
          "graph_type": 0,
          "graph_direction": "HORIZONTAL",
          "date_mode": "DATE",
          "store_value_as": "=password_value",
          "allow_table_row_selection": false,
          "is_searchable": false,
          "height": null,
          "image_fit": "CONTAIN"
        }
      ],
      "visibility": "tenant",
      "agent_guid": "020d4b8cceed45713c205da9feac1783",
      "success_message": "",
      "loading_message": "Please waitâ€¦",
      "logo_contents": "PHN2ZyB3aWR0aD0iMTkyMCIgaGVpZ2h0PSIxMDgwIiB2aWV3Qm94PSIwIDAg\nMTkyMCAxMDgwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5v\ncmcvMjAwMC9zdmciPgo8cmVjdCB3aWR0aD0iMTkyMCIgaGVpZ2h0PSIxMDgw\nIiBmaWxsPSIjOEQ3NUU2Ii8+CjxwYXRoIGQ9Ik05MDIuMjgxIDQ5OC44NjhI\nODgwLjAxNFY1MjIuMDM0SDkwMi4yODFWNTcyLjY0MUM5MDIuMjgxIDU5Ny44\nMzIgOTE4LjQ3NSA2MTIuMjI3IDk0My4yMTYgNjEyLjIyN0g5NjEuNDM0VjU4\nNy4yNjFIOTQ2LjM2NUM5MzYuMDE5IDU4Ny4yNjEgOTI5Ljk0NiA1ODEuNDEz\nIDkyOS45NDYgNTY5Ljk0MlY1MjIuMDM0SDk2MS40MzRWNDk4Ljg2OEg5Mjku\nOTQ2VjQ2NC42OEg5MDIuMjgxVjQ5OC44NjhaIiBmaWxsPSJ3aGl0ZSIvPgo8\ncGF0aCBkPSJNOTc0LjMyNyA0ODEuMDk5SDEwMDQuOTJWNDQ5LjYxSDk3NC4z\nMjdWNDgxLjA5OVpNMTAwMy4zNCA2MTIuMjI3VjQ5OC44NjhIOTc1LjY3NlY2\nMTIuMjI3SDEwMDMuMzRaIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNMTA0\nNy45NyA2MTIuMjI3VjU1MC4zNzRDMTA0Ny45NyA1MzMuNzMgMTA1OC43NiA1\nMjEuNTg0IDEwNzQuMjggNTIxLjU4NEMxMDg4LjQ1IDUyMS41ODQgMTA5Ny45\nIDUzMi4zODEgMTA5Ny45IDU0Ny45VjYxMi4yMjdIMTEyNS41NlY1NDIuMDUy\nQzExMjUuNTYgNTE1LjUxMiAxMTA4LjkyIDQ5Ny4wNjggMTA4My4yOCA0OTcu\nMDY4QzEwNjcuMDggNDk3LjA2OCAxMDU0LjI2IDUwNC4wNDEgMTA0Ny45NyA1\nMTYuNDExVjQ5OC44NjhIMTAyMC4zVjYxMi4yMjdIMTA0Ny45N1oiIGZpbGw9\nIndoaXRlIi8+CjxwYXRoIGQ9Ik0xMjIwLjUxIDU3NC40NEMxMjE3LjU4IDU4\nNS4yMzcgMTIwOC4zNiA1OTEuMDg0IDExOTQuMTkgNTkxLjA4NEMxMTc2LjY1\nIDU5MS4wODQgMTE2NC45NSA1NzkuMzg5IDExNjIuOTMgNTYxLjE3SDEyNDYu\nNkMxMjQ2LjgyIDU1OC45MjEgMTI0Ny4wNSA1NTUuNTQ3IDEyNDcuMDUgNTUx\nLjcyNEMxMjQ3LjA1IDUyNC43MzMgMTIyOS45NSA0OTcuMDY4IDExOTEuOTQg\nNDk3LjA2OEMxMTU0LjgzIDQ5Ny4wNjggMTEzNi4zOSA1MjUuMTgzIDExMzYu\nMzkgNTU1LjA5N0MxMTM2LjM5IDU4NC43ODcgMTE1Ny4wOCA2MTQuMDI2IDEx\nOTQuMTkgNjE0LjAyNkMxMjIyLjA4IDYxNC4wMjYgMTI0My4yMiA1OTguNTA3\nIDEyNDcuNSA1NzQuNDRIMTIyMC41MVpNMTE5MS45NCA1MTcuNzYxQzEyMDgu\nMzYgNTE3Ljc2MSAxMjE4LjI2IDUyOC41NTcgMTIxOS4zOCA1NDIuOTUySDEx\nNjMuNkMxMTY2LjUzIDUyNS44NTggMTE3Ni40MiA1MTcuNzYxIDExOTEuOTQg\nNTE3Ljc2MVoiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik0xMzAyLjU4IDYx\nNC4wMjZDMTMyOS4xMiA2MTQuMDI2IDEzNDYuNDQgNjAwLjA4MSAxMzQ2LjQ0\nIDU3OC43MTRDMTM0Ni40NCA1MjcuNDMyIDEyODMuNDcgNTU0LjQyMyAxMjgz\nLjQ3IDUyOS45MDZDMTI4My40NyA1MjIuMjU5IDEyODkuOTkgNTE3Ljc2MSAx\nMjk5Ljg4IDUxNy43NjFDMTMwOC42NiA1MTcuNzYxIDEzMTguMzMgNTIzLjE1\nOSAxMzE5LjkgNTMzLjczSDEzNDUuMDlDMTM0My45NyA1MTEuNjg4IDEzMjUu\nNzUgNDk3LjA2OCAxMjk5LjIxIDQ5Ny4wNjhDMTI3NS44MiA0OTcuMDY4IDEy\nNTguNSA1MTEuMDEzIDEyNTguNSA1MzAuODA2QzEyNTguNSA1NzguNzE0IDEz\nMjAuNTggNTU0LjY0OCAxMzIwLjU4IDU3OS44MzlDMTMyMC41OCA1ODYuNTg2\nIDEzMTMuMzggNTkxLjk4NCAxMzAyLjU4IDU5MS45ODRDMTI5MC4yMSA1OTEu\nOTg0IDEyODEuODkgNTg1LjIzNyAxMjgwLjc3IDU3NC40NEgxMjU1LjU4QzEy\nNTYuOTMgNTk4LjczMiAxMjc1LjE0IDYxNC4wMjYgMTMwMi41OCA2MTQuMDI2\nWiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBj\nbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik02NTguMzk3IDQyMEM2MjkuOTkzIDQy\nMCA2MDQuODc4IDQzOC40MzEgNTk2LjM3OCA0NjUuNTE1TDU3MyA1NDBMNTk2\nLjM3OCA2MTQuNDg1QzYwNC44NzggNjQxLjU2OSA2MjkuOTkzIDY2MCA2NTgu\nMzk3IDY2MEg3MjEuMzY5Qzc0OS43NzMgNjYwIDc3NC44ODcgNjQxLjU2OSA3\nODMuMzg4IDYxNC40ODVMODA2Ljc2NiA1NDBMNzgzLjM4OCA0NjUuNTE1Qzc3\nNC44ODcgNDM4LjQzMSA3NDkuNzczIDQyMCA3MjEuMzY5IDQyMEg2NTguMzk3\nWk03MjEuMzcgNDM4LjcyM0M3NDEuNTg3IDQzOC43MjMgNzU5LjQ2MiA0NTEu\nODQxIDc2NS41MTMgNDcxLjExOEw3NzEuMjQ0IDQ4OS4zOEM3NTkuNzE0IDQ3\nOS44NjEgNzQ1LjExMyA0NzQuNTA0IDcyOS44NTIgNDc0LjUwM0w2NDkuNzQz\nIDQ3NC41MDFDNjM0LjU4NSA0NzQuNTAyIDYyMC4wNzggNDc5Ljc4OCA2MDgu\nNTg1IDQ4OS4xODZMNjE0LjI1NSA0NzEuMTE4QzYyMC4zMDYgNDUxLjg0MSA2\nMzguMTgxIDQzOC43MjMgNjU4LjM5OCA0MzguNzIzSDcyMS4zN1pNNjEyLjkw\nOSA1MTEuNDg5TDU5OC4zNTMgNTMwLjYzOUw3ODEuMjQxIDUzMC42MzlMNzY2\nLjY4NyA1MTEuNDkyQzc1Ny45MzkgNDk5Ljk4NSA3NDQuMzExIDQ5My4yMjcg\nNzI5Ljg1MSA0OTMuMjI2SDY0OS4zMDdDNjM1LjAxIDQ5My4zNjEgNjIxLjU2\nOCA1MDAuMDk5IDYxMi45MDkgNTExLjQ4OVpNNzgxLjIxMiA1NDkuMzYyTDc2\nNi42ODUgNTY4LjQ5MkM3NTcuOTM3IDU4MC4wMTEgNzQ0LjMgNTg2Ljc3NyA3\nMjkuODI4IDU4Ni43NzZMNjQ5Ljc2NSA1ODYuNzc0QzYzNS4yOTQgNTg2Ljc3\nNSA2MjEuNjU2IDU4MC4wMDkgNjEyLjkwOCA1NjguNDg5TDU5OC4zODMgNTQ5\nLjM2Mkw3ODEuMjEyIDU0OS4zNjJaTTYxNC4yNTQgNjA4Ljg4MkM2MjAuMzA1\nIDYyOC4xNTkgNjM4LjE4IDY0MS4yNzcgNjU4LjM5NyA2NDEuMjc3SDcyMS4z\nNjlDNzQxLjU4NiA2NDEuMjc3IDc1OS40NjEgNjI4LjE1OSA3NjUuNTExIDYw\nOC44ODJMNzcxLjI0NyA1OTAuNjA3Qzc1OS43MTIgNjAwLjEzNiA3NDUuMSA2\nMDUuNSA3MjkuODI3IDYwNS40OTlMNjQ5Ljc2NiA2MDUuNDk3QzYzNC41OTYg\nNjA1LjQ5OCA2MjAuMDc3IDYwMC4yMDYgNjA4LjU3OCA1OTAuNzk1TDYxNC4y\nNTQgNjA4Ljg4MloiIGZpbGw9IndoaXRlIi8+Cjwvc3ZnPgo=\n",
      "logo_filename": "TinesLogoWhite-PurpleBG.svg",
      "display_logo": true,
      "icon": ":adhesive_bandage:",
      "sso_groups": null
    },
    {
      "containers": [
        {
          "guid": "de5dfdea5c64ccac9cdc5423a4a97802",
          "ranking": 0,
          "category": 0
        },
        {
          "guid": "39b336937edbe2064503e81ffc45a6ab",
          "ranking": 1,
          "category": 0
        },
        {
          "guid": "cafeb1b9466bd395364301c6c3d5544e",
          "ranking": 2,
          "category": 0
        }
      ],
      "conditions": [],
      "fields": [
        {
          "guid": "424c19c50d96865ea1ac19630716fd0d",
          "name": "Heading",
          "description": "",
          "required": false,
          "type": "TITLE",
          "multi_select": false,
          "options": [
            "Option 1",
            "Option 2"
          ],
          "ranking": 0,
          "max_characters": null,
          "default_value": null,
          "content": "My new page âœ¨",
          "validation_pattern": null,
          "style": "primary",
          "container_guid": "de5dfdea5c64ccac9cdc5423a4a97802",
          "graph_type": 0,
          "graph_direction": "HORIZONTAL",
          "date_mode": "DATE",
          "store_value_as": "",
          "allow_table_row_selection": false,
          "is_searchable": false,
          "height": null,
          "image_fit": "CONTAIN"
        },
        {
          "guid": "5eedcb817a4b033e9fe5c061ed5d6cb9",
          "name": "Paragraph",
          "description": "",
          "required": false,
          "type": "PARAGRAPH",
          "multi_select": false,
          "options": [
            "Option 1",
            "Option 2"
          ],
          "ranking": 0,
          "max_characters": null,
          "default_value": null,
          "content": "Use the panel on the left to style and manage your page. Edit, sort, and delete page elements by selecting them on the page. And add new elements by dragging them from the left panel and onto the page.",
          "validation_pattern": null,
          "style": "primary",
          "container_guid": "39b336937edbe2064503e81ffc45a6ab",
          "graph_type": 0,
          "graph_direction": "HORIZONTAL",
          "date_mode": "DATE",
          "store_value_as": "",
          "allow_table_row_selection": false,
          "is_searchable": false,
          "height": null,
          "image_fit": "CONTAIN"
        },
        {
          "guid": "363e0e8d962722cadeef0df5f1fc0cbe",
          "name": "Button",
          "description": "",
          "required": false,
          "type": "BUTTON",
          "multi_select": false,
          "options": [
            "Option 1",
            "Option 2"
          ],
          "ranking": 0,
          "max_characters": null,
          "default_value": null,
          "content": "Submit",
          "validation_pattern": null,
          "style": "primary",
          "container_guid": "cafeb1b9466bd395364301c6c3d5544e",
          "graph_type": 0,
          "graph_direction": "HORIZONTAL",
          "date_mode": "DATE",
          "store_value_as": "",
          "allow_table_row_selection": false,
          "is_searchable": false,
          "height": null,
          "image_fit": "CONTAIN"
        }
      ],
      "visibility": "tenant",
      "agent_guid": "d385158d27cb5ba5f24c2e8d820b286a",
      "success_message": "",
      "loading_message": "",
      "logo_contents": "iVBORw0KGgoAAAANSUhEUgAAAFQAAAAYCAYAAABk8drWAAAACXBIWXMAAAsT\nAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAARCSURB\nVHgB7VhLctpAEB1k7LVyA/kEgRMEn8BQ5e8qcALjE1icAPsEkJW/VeATwA1Q\nTmDlBCE7l3/kPblbTIiMJcVOeaFXBRrN9Mz0vOnu6ZExBQoUKFCgwAdByX4Z\nDAbuw8PDwWw2a+LVk+rAcZxgZWWl02g0QpMSl5eXXRlnvLq62kLfqcmIi4uL\nZqlU+lwulztJ/aGvJ/p+39nZ6cu8R3j30c/f3t7umP8MRwtXV1df7+/vb6iM\nmZNJVJ6enppom5ydnbVNCpAIjENZF786Fn1kMgLE1PDocRz0HyTJQKe2zNOj\nMbBO3o1sZgS2Ybw29KqYd0ZEKMg8AGl980zAS3BhqV0Sv0Qmsho8/iCQi5T6\nXED/WtJmoj7W9/b2Vgk9gXUGWM+JtoF4H/VdFEdK/HvB4UIxuZ+2A2SPlykF\nayLhXkJ9z/wDsJlHaTZld3fXR4ho7O3tHWudRbyrxC+Ca+L4rxFuyXlJ7c7j\n4yOtKcuuuXd3d+0XJvMkZPwFWpm4cV64sLTBawuGB/UYus7Pz7vUB3NOYLGx\nV+EsuIHrT2ydITNCn5/sxyfaKdO0x02Qo8wNY7Yt52ChmeOKraAN2ZxlyBxL\nZb6xFCuvxWN4UE361PGYYn1egli0KSQJxIy42VIfso959rCehplFOYYUkY0M\nCJvn68C5CDUJLi2ho7msExVa3Pk0QL9veJxIuZ3W0pkZIMNYR3GodSBjA3VV\nlsUAPK1HprCOuqoQpmHGRV3FzNfcQvZQpSx06YjcFx3fMW8E7mBK0W6egwEk\n+ObZKkjqIO0hR1Ih/0vfYeGhpmAwgLpUX4OkMQv7+/shCNV0i+GtBrlYX5Kn\n2QLjNTeCMVvby6KkZ7IhsF/E6jyTDhqDfZMBJAHzUHHGP1cOuR8mJ05PTz0z\nPzs2MfZM20BgLAfCXGzmEAYTWbN4YRPy3JQxNusauo1V3hF3yopg4T1TbISS\nB3nSKLhZgL6HLDN8oLxp3ga8vPSTfnD3MTcTzw1ypeHASI6NX88+5Jy1tTWm\nF1luMRw8voHIKeeZbHBTHGCJgGseW4dU7pySrm3m6w62trZa9o/kQcdrkTNw\naw9c8fZVhcV+oqtb5FY0DDgSTw7TKgKT7+gkhH0jyQK6Tt4kG+7eMtmMIAas\nLj6ELULqtsfw8oJ1jdA+YGjgLYvvPCcoR84Yc63+UWiIxucf78HiSsuUZFvL\nTpgF73rzSAI3FMS0MnQJtUCSmD/KdwvdGFfyygnb5NZIBGI8ShzTpwnzUcpa\nWU2oh1p8ytOVmDIsxIlImOkB0w/9AGFDFhaabJhCmcNlH0zgYoGxXHKxHW45\n1LSF86vXQPdQ6sYqy7BmhYlofs7NPpImaZumR5y3jzVvsFLI0nW6ko9WRG6o\naVg0v/nA0JCwjHhx1aktw3jGA+yF8dykr2ZisRVsZLg4XpIcSGWOG+b5ilag\nQIECBZLxG5sJ41WbSDouAAAAAElFTkSuQmCC\n",
      "logo_filename": "image",
      "display_logo": false,
      "icon": ":hourglass:",
      "sso_groups": null
    }
  ],
  "tags": [],
  "time_saved_unit": "minutes",
  "time_saved_value": 0,
  "origin_story_identifier": "cloud:0babdfaca84c3865dc5749e64fde82f5:c7ab9dca268e2beb0e350df8150ed8e6",
  "integration_product": null,
  "integration_vendor": null,
  "llm_product_instructions": "",
  "exported_at": "2025-02-22T21:26:16Z",
  "icon": ":hammer_and_pick:",
  "integrations": [
    {
      "action_inputs": [
        {
          "name": "Tenant domain",
          "description": "The domain of the tenant.",
          "required": true,
          "type": "TEXT",
          "ranking": 0,
          "value": "\"<<META.tenant.domain>>\"",
          "options": [
            "Option 1",
            "Option 2"
          ],
          "is_collapsed": false,
          "sub_type": "HTML",
          "multi_select_enabled": false,
          "llm_json_schema": "{}"
        },
        {
          "name": "Tines credential",
          "description": "",
          "required": false,
          "type": "CREDENTIAL",
          "ranking": 1073741824,
          "value": "\"=CREDENTIAL.tines_resources\"",
          "options": [
            "Option 1",
            "Option 2"
          ],
          "is_collapsed": false,
          "sub_type": "HTML",
          "multi_select_enabled": false,
          "llm_json_schema": "{}"
        },
        {
          "name": "Resource ID",
          "description": "The ID of the resource you are querying for. You can identify this with the INFO key.",
          "required": false,
          "type": "NUMBER",
          "ranking": 1610612736,
          "value": "\"=INFO.resource.ip_sunset_list.id\"",
          "options": [
            "Option 1",
            "Option 2"
          ],
          "is_collapsed": false,
          "sub_type": "HTML",
          "multi_select_enabled": false,
          "llm_json_schema": "{}"
        },
        {
          "name": "Index",
          "description": "The index of the element to remove if removing from an array (with indexes starting at 0). You must use either the key or index parameter.",
          "required": false,
          "type": "NUMBER",
          "ranking": 2013265920,
          "value": "\"=INDEX_OF(RESOURCE.ip_sunset_list, LAMBDA(item, item.ip = explode_ips.ip))\"",
          "options": [
            "Option 1",
            "Option 2"
          ],
          "is_collapsed": false,
          "sub_type": "HTML",
          "multi_select_enabled": false,
          "llm_json_schema": "{}"
        },
        {
          "name": "Is test resource?",
          "description": "Select 'yes' to remove an element from the test resource.",
          "required": false,
          "type": "BOOLEAN",
          "ranking": 2080374784,
          "value": "\"\"",
          "options": [
            "Option 1",
            "Option 2"
          ],
          "is_collapsed": true,
          "sub_type": "HTML",
          "multi_select_enabled": false,
          "llm_json_schema": "{}"
        },
        {
          "name": "Key",
          "description": "The object key to remove if removing from an object. You must use either the key or index parameter.",
          "required": false,
          "type": "TEXT",
          "ranking": 2113929216,
          "value": "\"\"",
          "options": [
            "Option 1",
            "Option 2"
          ],
          "is_collapsed": true,
          "sub_type": "HTML",
          "multi_select_enabled": false,
          "llm_json_schema": "{}"
        }
      ],
      "action_guid": "133ed74ef5f8f8804b61a2bf1cd7646a",
      "product": "Tines",
      "action_options_keys": []
    },
    {
      "action_inputs": [
        {
          "name": "IP Address",
          "description": "The IP address you are searching for.",
          "required": true,
          "type": "TEXT",
          "ranking": 0,
          "value": "\"<<explode_ips.ip>>\"",
          "options": [
            "Option 1",
            "Option 2"
          ],
          "is_collapsed": false,
          "sub_type": "HTML",
          "multi_select_enabled": false,
          "llm_json_schema": "{}"
        },
        {
          "name": "Virustotal Credential",
          "description": "",
          "required": true,
          "type": "CREDENTIAL",
          "ranking": 1073741824,
          "value": "\"=CREDENTIAL.virustotal\"",
          "options": [
            "Option 1",
            "Option 2"
          ],
          "is_collapsed": false,
          "sub_type": "HTML",
          "multi_select_enabled": false,
          "llm_json_schema": "{}"
        }
      ],
      "action_guid": "1348fa66f3dfa0892fc26529496c8cc3",
      "product": "VirusTotal",
      "action_options_keys": []
    },
    {
      "action_inputs": [
        {
          "name": "URLScan Credential",
          "description": "",
          "required": true,
          "type": "CREDENTIAL",
          "ranking": 0,
          "value": "\"=CREDENTIAL.urlscan_io\"",
          "options": [
            "Option 1",
            "Option 2"
          ],
          "is_collapsed": false,
          "sub_type": "HTML",
          "multi_select_enabled": false,
          "llm_json_schema": "{}"
        },
        {
          "name": "Size",
          "description": "Number of results returned. Default 100, Max 10,000 (depending on your subscription)",
          "required": false,
          "type": "NUMBER",
          "ranking": 1073741824,
          "value": "\"\"",
          "options": [
            "Option 1",
            "Option 2"
          ],
          "is_collapsed": true,
          "sub_type": "HTML",
          "multi_select_enabled": false,
          "llm_json_schema": "{}"
        },
        {
          "name": "Query",
          "description": "For a comprehensive list of available searchable fields, consult the [URLscan Search API reference](https://urlscan.io/docs/search/).",
          "required": true,
          "type": "CODE",
          "ranking": 1879048192,
          "value": "\"ip:\\\"<<explode_ips.ip>>\\\"\"",
          "options": [
            "Option 1",
            "Option 2"
          ],
          "is_collapsed": false,
          "sub_type": "SQL",
          "multi_select_enabled": false,
          "llm_json_schema": "{}"
        },
        {
          "name": "Search after",
          "description": "For retrieving the next batch of results, value of the 'sort' attribute of the last (oldest) result you received (comma-separated).\n\n`JOIN(LAST(search_for_ip_address.body.results).sort, \",\")`",
          "required": false,
          "type": "TEXT",
          "ranking": 2013265920,
          "value": "\"\"",
          "options": [
            "Option 1",
            "Option 2"
          ],
          "is_collapsed": true,
          "sub_type": "HTML",
          "multi_select_enabled": false,
          "llm_json_schema": "{}"
        }
      ],
      "action_guid": "71c3bd8ea360570deeaf210943d774a9",
      "product": "URLScan.io",
      "action_options_keys": []
    },
    {
      "action_inputs": [
        {
          "name": "IP Address",
          "description": "The IP address you are searching for.",
          "required": true,
          "type": "TEXT",
          "ranking": 0,
          "value": "\"<<explode_ips.ip>>\"",
          "options": [
            "Option 1",
            "Option 2"
          ],
          "is_collapsed": false,
          "sub_type": "HTML",
          "multi_select_enabled": false,
          "llm_json_schema": "{}"
        },
        {
          "name": "Virustotal Credential",
          "description": "",
          "required": true,
          "type": "CREDENTIAL",
          "ranking": 1073741824,
          "value": "\"=CREDENTIAL.virustotal\"",
          "options": [
            "Option 1",
            "Option 2"
          ],
          "is_collapsed": false,
          "sub_type": "HTML",
          "multi_select_enabled": false,
          "llm_json_schema": "{}"
        }
      ],
      "action_guid": "e3a8311c24c4a937b9be0bd0357f370d",
      "product": "VirusTotal",
      "action_options_keys": []
    },
    {
      "action_inputs": [
        {
          "name": "Tenant domain",
          "description": "The domain of the tenant.",
          "required": true,
          "type": "TEXT",
          "ranking": 0,
          "value": "\"<<META.tenant.domain>>\"",
          "options": [
            "Option 1",
            "Option 2"
          ],
          "is_collapsed": false,
          "sub_type": "HTML",
          "multi_select_enabled": false,
          "llm_json_schema": "{}"
        },
        {
          "name": "Tines credential",
          "description": "",
          "required": false,
          "type": "CREDENTIAL",
          "ranking": 1073741824,
          "value": "\"=CREDENTIAL.tines_resources\"",
          "options": [
            "Option 1",
            "Option 2"
          ],
          "is_collapsed": false,
          "sub_type": "HTML",
          "multi_select_enabled": false,
          "llm_json_schema": "{}"
        },
        {
          "name": "Resource ID",
          "description": "The ID of the resource you are querying for. You can identify this with the INFO key.",
          "required": false,
          "type": "NUMBER",
          "ranking": 1610612736,
          "value": "\"=INFO.resource.ip_sunset_list.id\"",
          "options": [
            "Option 1",
            "Option 2"
          ],
          "is_collapsed": false,
          "sub_type": "HTML",
          "multi_select_enabled": false,
          "llm_json_schema": "{}"
        },
        {
          "name": "Is test resource?",
          "description": "Select 'yes' to append an element to the test resource.",
          "required": false,
          "type": "BOOLEAN",
          "ranking": 1879048192,
          "value": "\"\"",
          "options": [
            "Option 1",
            "Option 2"
          ],
          "is_collapsed": true,
          "sub_type": "HTML",
          "multi_select_enabled": false,
          "llm_json_schema": "{}"
        },
        {
          "name": "Text value",
          "description": "The text to append to the resource. Use this input instead of the 'Array value' input if you are just appending text.",
          "required": false,
          "type": "TEXT",
          "ranking": 2013265920,
          "value": "\"\"",
          "options": [
            "Option 1",
            "Option 2"
          ],
          "is_collapsed": true,
          "sub_type": "HTML",
          "multi_select_enabled": false,
          "llm_json_schema": "{}"
        },
        {
          "name": "Array value",
          "description": "The array to append to the resource. Use this input instead of the 'Text value' input if you are appending an array.",
          "required": false,
          "type": "OBJECT",
          "ranking": 2080374784,
          "value": "\"=create_ioc_object.ioc_object\"",
          "options": [
            "Option 1",
            "Option 2"
          ],
          "is_collapsed": false,
          "sub_type": "HTML",
          "multi_select_enabled": false,
          "llm_json_schema": "{}"
        }
      ],
      "action_guid": "ec580a14ba1ed274a52c4924a86163a1",
      "product": "Tines",
      "action_options_keys": []
    },
    {
      "action_inputs": [
        {
          "name": "Tenant domain",
          "description": "The domain of the tenant.",
          "required": true,
          "type": "TEXT",
          "ranking": 0,
          "value": "\"<<META.tenant.domain>>\"",
          "options": [
            "Option 1",
            "Option 2"
          ],
          "is_collapsed": false,
          "sub_type": "HTML",
          "multi_select_enabled": false,
          "llm_json_schema": "{}"
        },
        {
          "name": "Tines credential",
          "description": "",
          "required": false,
          "type": "CREDENTIAL",
          "ranking": 1073741824,
          "value": "\"=CREDENTIAL.tines_resources\"",
          "options": [
            "Option 1",
            "Option 2"
          ],
          "is_collapsed": false,
          "sub_type": "HTML",
          "multi_select_enabled": false,
          "llm_json_schema": "{}"
        },
        {
          "name": "Resource ID",
          "description": "The ID of the resource you are querying for. You can identify this with the INFO key.",
          "required": false,
          "type": "NUMBER",
          "ranking": 1610612736,
          "value": "\"=INFO.resource.ip_sunset_list.id\"",
          "options": [
            "Option 1",
            "Option 2"
          ],
          "is_collapsed": false,
          "sub_type": "HTML",
          "multi_select_enabled": false,
          "llm_json_schema": "{}"
        },
        {
          "name": "Index",
          "description": "The index of the element to remove if removing from an array (with indexes starting at 0). You must use either the key or index parameter.",
          "required": false,
          "type": "NUMBER",
          "ranking": 1879048192,
          "value": "\"=INDEX_OF(RESOURCE.ip_sunset_list, LAMBDA(item, item.ip = explode_ips.ip))\"",
          "options": [
            "Option 1",
            "Option 2"
          ],
          "is_collapsed": false,
          "sub_type": "HTML",
          "multi_select_enabled": false,
          "llm_json_schema": "{}"
        },
        {
          "name": "Is test resource?",
          "description": "Select 'yes' to remove an element from the test resource.",
          "required": false,
          "type": "BOOLEAN",
          "ranking": 2013265920,
          "value": "\"\"",
          "options": [
            "Option 1",
            "Option 2"
          ],
          "is_collapsed": true,
          "sub_type": "HTML",
          "multi_select_enabled": false,
          "llm_json_schema": "{}"
        },
        {
          "name": "Key",
          "description": "The object key to remove if removing from an object. You must use either the key or index parameter.",
          "required": false,
          "type": "TEXT",
          "ranking": 2080374784,
          "value": "\"\"",
          "options": [
            "Option 1",
            "Option 2"
          ],
          "is_collapsed": true,
          "sub_type": "HTML",
          "multi_select_enabled": false,
          "llm_json_schema": "{}"
        }
      ],
      "action_guid": "fc014060ecc5774236d10f9107c720a6",
      "product": "Tines",
      "action_options_keys": []
    }
  ]
}